#!/bin/bash

if [ -z "$HELIUM_REALPATH_WORKSPACE" ]; then
	echo "HELIUM_REALPATH_WORKSPACE must be set"
	exit 1
fi

if [ -z "$HELIUM_REALPATH_CACHE" ]; then
	echo "$HELIUM_REALPATH_CACHE must be set"
	exit 1
fi

mkdir -p /helium/realpaths/
echo -n "${HELIUM_REALPATH_WORKSPACE%/}/" > /helium/realpaths/workspace
echo -n "${HELIUM_REALPATH_CACHE%/}/" > /helium/realpaths/cache
chmod 600 /helium/realpaths/*

exec sudo -u helium --preserve-env -H -- env "PATH=$PATH" "$@"

